---
import { getCollection } from "astro:content";
import Layout from "../layouts/Home.astro";
import metadata from "../content/_metadata";
import filterOutDraftsIfProduction from "../utils/filterOutDraftsIfProduction";
import firstFive from "../utils/firstFive";
import labelDrafts from "../utils/labelDrafts";
import sortByDate from "../utils/sortByDate";

const { title, description } = metadata;

const allPosts = await getCollection('posts');

const posts = labelDrafts(firstFive(filterOutDraftsIfProduction(sortByDate(allPosts))));

const categories = await getCollection('categories');
---

<Layout posts={posts} categories={categories} title={title} description={description}/>
